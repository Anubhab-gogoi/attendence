<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Research Scholar Attendance</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f9;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }
    th {
      background: #333;
      color: #fff;
    }
    select {
      padding: 5px;
      border-radius: 5px;
      border: 1px solid #999;
    }
    .share-link {
      margin-top: 20px;
      text-align: center;
    }
    button {
      padding: 10px 20px;
      border: none;
      background: #007bff;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>
 <h1 style="margin-bottom:5px;">Applied Photonics and Nanophotonics Lab</h1>
<h2 style="margin-top:0; margin-bottom:5px; font-weight:normal; color:#444;">Tezpur University</h2>
<h3 style="margin-top:0; color:#555;">Research Scholar Attendance</h3>

  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Current Location</th>
      </tr>
    </thead>
    <tbody id="attendanceTable">
      <!-- Rows will be added by JavaScript -->
    </tbody>
  </table>

  <div class="share-link">
    <button onclick="copyLink()">Copy Shareable URL</button>
    <p id="copiedMsg" style="color:green; display:none;">Link copied!</p>
  </div>

<script>
  const apiURL = "PASTE_YOUR_WEB_APP_URL_HERE";  // from Apps Script

  const scholars = [
    "Biprav Chetry",
    "Chunuranjan Dutta",
    "Nituraj Changmai",
    "Suchibrata Saikia",
    "Takio Yagin",
    "Anubhab Parashar Gogoi"
  ];

  const locations = [
    "APN LAB-1",
    "APN LAB-2 (MRL)",
    "LIBRARY",
    "CANTEEN",
    "OTHERS",
    "HOSTEL"
  ];

  const tableBody = document.getElementById("attendanceTable");

  async function loadAttendance() {
    const response = await fetch(apiURL);
    const data = await response.json();

    tableBody.innerHTML = "";
    data.forEach(scholar => {
      const row = document.createElement("tr");

      const nameCell = document.createElement("td");
      nameCell.textContent = scholar.name;

      const locationCell = document.createElement("td");
      const select = document.createElement("select");

      locations.forEach(loc => {
        const option = document.createElement("option");
        option.value = loc;
        option.textContent = loc;
        if (scholar.location === loc) option.selected = true;
        select.appendChild(option);
      });

      select.addEventListener("change", async () => {
        await fetch(apiURL, {
          method: "POST",
          body: JSON.stringify({ name: scholar.name, location: select.value })
        });
        loadAttendance(); // refresh table
      });

      locationCell.appendChild(select);

      const timeCell = document.createElement("td");
      timeCell.textContent = scholar.updated || "";

      row.appendChild(nameCell);
      row.appendChild(locationCell);
      row.appendChild(timeCell);
      tableBody.appendChild(row);
    });
  }

  loadAttendance();
  setInterval(loadAttendance, 10000); // refresh every 10s
</script>
